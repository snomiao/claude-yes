services:
  # docker compose run --build -t claude-yes
  agent-yes:
    build: .
    # image: snomiao/agent-yes
    stdin_open: true
    tty: true
    volumes:
      # Note: Not mounting ./:/app to avoid overwriting built files including fixed bun-pty
      # For development with hot reload, use: docker compose up --watch
      # - ./:/app

      # CLI credentials (mount with :ro for read-only security)

      # persist agent credentials
      # you can run seed-credentials.sh to copy from /root
      - ./.agent-yes/home:/root
    command: --help
    
    # Environment variables for API keys (uncomment and set as needed)
    # environment:
    # OPENAI_API_KEY: ${OPENAI_API_KEY}
    # ANTHROPIC_API_KEY: ${ANTHROPIC_API_KEY}
    # GOOGLE_API_KEY: ${GOOGLE_API_KEY}
    # XAI_API_KEY: ${XAI_API_KEY}  # For Grok
    # QWEN_API_KEY: ${QWEN_API_KEY}
    # AUGMENT_API_KEY: ${AUGMENT_API_KEY}

    # Use bun to run the built binary (node has ES module issues with node-pty)
    # command: hello

    # run
    # docker compose up --watch
    develop:
      watch:
        - action: rebuild
          path: docker-compose.yaml
        - action: rebuild
          path: ./Dockerfile

